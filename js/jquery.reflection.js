!function(t){t.fn.reflect=function(e){return e=t.extend({height:1/3,opacity:.5},e),this.unreflect().each((function(){var a=this;function i(){var i,r,s,n=a.width,o=a.height,c=Math.floor(1<e.height?Math.min(o,e.height):o*e.height),l=t("<canvas />")[0];if(l.getContext){r=l.getContext("2d");try{t(l).attr({width:n,height:c}),r.save(),r.translate(0,o-1),r.scale(1,-1),r.drawImage(a,0,0,n,o),r.restore(),r.globalCompositeOperation="destination-out",(s=r.createLinearGradient(0,0,0,c)).addColorStop(0,"rgba(255, 255, 255, "+(1-e.opacity)+")"),s.addColorStop(1,"rgba(255, 255, 255, 1.0)"),r.fillStyle=s,r.rect(0,0,n,c),r.fill()}catch(i){return}}else{if(!window.ActiveXObject)return;l=t("<img />").attr("src",a.src).css({width:n,height:o,marginBottom:c-o,filter:"FlipV progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*e.opacity+", FinishOpacity=0, Style=1, StartX=0, StartY=0, FinishX=0, FinishY="+c/o*100+")"})[0]}t(l).css({display:"block",border:0}),(i=t(/^a$/i.test(a.parentNode.tagName)?"<span />":"<div />").insertAfter(a).append([a,l])[0]).className=a.className,t(a).data("reflected",i.style.cssText=a.style.cssText),t(i).css({width:n,height:o+c,overflow:"hidden"}),a.style.cssText="display: block; border: 0px",a.className="reflected"}/^img$/i.test(a.tagName)&&(a.complete?i():t(a).load(i))}))},t.fn.unreflect=function(){return this.unbind("load").each((function(){var e,a=this,i=t(this).data("reflected");void 0!==i&&(e=a.parentNode,a.className=e.className,a.style.cssText=i,t(a).data("reflected",null),e.parentNode.replaceChild(a,e))}))}}(window.jQuery||window.Zepto);